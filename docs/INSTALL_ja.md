# LiquidAiNanoAppPiiMasker インストールガイド（Windows）

このドキュメントは、LiquidAiNanoAppPiiMasker の配布パッケージ（ZIP）からのセットアップ、初回起動手順、更新・アンインストール、トラブルシューティングを説明します。

## 対象
- Windows 10/11（64bit）上で LiquidAiNanoAppPiiMasker を利用するユーザー
- 配布形態：ZIP（ポータブル配布）

## システム要件
- OS: Windows 10/11（64bit）
- 必須ランタイム: .NET デスクトップ ランタイム 8.0（x64）
  - ダウンロード（Microsoft 公式）:
    - https://dotnet.microsoft.com/ja-jp/download/dotnet/8.0
    - 上記ページで「.NET Desktop Runtime 8.x（x64）」を選択・インストールしてください
- CPU: x64（LLamaSharp CPU バックエンド使用時は AVX2 対応 CPU を推奨）
- メモリ: 8 GB 以上を推奨
- ストレージ: 展開先に 500 MB 以上の空き容量（初回モデルダウンロード時に追加容量が必要）
- ネットワーク: 初回モデル自動ダウンロード時にインターネット接続が必要（以降はオフライン可）

## 事前確認（.NET ランタイム）
- 既に .NET デスクトップ ランタイム 8.0（x64）が入っている場合、この手順は不要です
- 不明な場合は、上記リンクからランタイムをインストールしてください（インストーラーは重複インストールを適切に処理します）

## 配布物
- ファイル名例: `LiquidAiNanoAppPiiMasker-win-framework.zip`
- 展開後に起動する実行ファイル: `LiquidAiNanoAppPiiMasker.exe`

## インストール手順（ポータブル）
LiquidAiNanoAppPiiMasker はインストーラー不要のポータブル配布です。管理者権限は不要です。

1. 配布 ZIP の入手
   - 例: `LiquidAiNanoAppPiiMasker-win-framework.zip`

2. ZIP を展開
   - ZIP を右クリック →「すべて展開」を選択し、任意のフォルダー（例: ドキュメント、デスクトップ等）に展開します
   - 注意: ZIP 内のファイルを展開せずに直接実行しないでください（依存ファイルが読み込めず起動に失敗する場合があります）

3. 初回起動
   - 展開先フォルダー内の「`LiquidAiNanoAppPiiMasker.exe`」をダブルクリックして起動します
   - Windows SmartScreen が表示された場合:
     - 「詳細情報」をクリック →「実行」を選択してください
   - インターネットから取得されたファイル扱いの場合、プロパティに「ブロックの解除」チェックが表示されることがあります
     - exe を右クリック →「プロパティ」→「全般」→「ブロックの解除」にチェック →「OK」

4. 日本語表示について
   - 配布物に言語リソースが含まれている場合、OS 言語設定に応じて日本語 UI が表示されます

5. ショートカット作成（任意）
   - exe を右クリック →「送る」→「デスクトップ（ショートカットを作成）」

## 使い方（トレイ常駐＋ドラッグ＆ドロップ UI）
- アプリは起動すると「システムトレイ」に常駐します
  - 右クリック: コンテキストメニュー
    - Mask File…（ファイルを選択してマスク）
    - Mask Folder…（フォルダー配下を一括マスク）
    - Auto-open file after masking（マスク完了後に自動で開く設定の切替）
    - Show Debug Logs…（ログファイルを開く）
    - Exit（終了）
  - 左クリック: シンプルな小さなウィンドウを表示
    - ウィンドウにファイルやフォルダーをドラッグ＆ドロップでマスクを開始できます
    - 対応拡張子: .docx / .pptx / .xlsx / .txt / .md / .rtf
- 初回モデル自動ダウンロード
  - 初回は PII 抽出用モデルを自動ダウンロードします（回線状況により時間がかかる場合があります）
  - 保存先: `%LOCALAPPDATA%\LiquidAiNanoAppPiiMasker\models\`
  - ダウンロード状況やエラーはバルーン通知およびログに出力されます

## ログ / 設定ファイル
- ログファイル: `%LOCALAPPDATA%\LiquidAiNanoAppPiiMasker\pii_masker_log.txt`
- 設定ファイル（簡易）: `%LOCALAPPDATA%\LiquidAiNanoAppPiiMasker\settings.ini`（Auto-open のオン/オフ）

## 更新（アップデート）
- 新バージョン ZIP を展開し、旧バージョンのフォルダーを新しいフォルダーで置き換えてください
- 既存のショートカットを使っている場合は、リンク先が新しいフォルダーを指していることを確認してください
- ログ・モデルなどユーザーデータは `%LOCALAPPDATA%\LiquidAiNanoAppPiiMasker\` 配下に保持されます（必要に応じてバックアップしてください）

## アンインストール
- 展開したアプリのフォルダーを削除してください
- 併せてショートカットも削除してください
- レジストリやシステムフォルダーへの書き込みは行いません（ポータブル配布）
- 必要に応じて `%LOCALAPPDATA%\LiquidAiNanoAppPiiMasker\` を削除してください（ログ・モデルなど）

## トラブルシューティング
- アプリが起動しない / 「0xc0000135」等のエラー
  - .NET デスクトップ ランタイム 8.0（x64）が未インストールの可能性。上記リンクからインストールしてください
- トレイアイコンは見えるが UI が表示されない
  - トレイアイコンを「左クリック」して、ドラッグ＆ドロップ用ウィンドウを表示してください
- モデルのダウンロードが失敗する
  - ネットワーク接続を確認のうえ再実行してください。`Show Debug Logs…` からログを確認できます
- DLL が見つからない / 依存関係エラー
  - ZIP を展開せずに直接実行している可能性。必ず「すべて展開」したフォルダー内から実行してください
- SmartScreen によりブロックされる
  - 「詳細情報」→「実行」を選択、またはプロパティの「ブロックの解除」を行ってください
- 権限エラー（保存/更新時）
  - 展開先が Program Files 等の書き込み制限フォルダーの場合、ユーザーフォルダー配下（ドキュメント等）へ移動して実行してください
- パフォーマンスが低い
  - AVX2 非対応 CPU では CPU バックエンド利用時に性能が低下する場合があります。可能であれば AVX2 対応 CPU の利用を推奨します

## ライセンスとサードパーティコンポーネント
LiquidAiNanoAppPiiMasker は以下の OSS を利用しています（一部抜粋）:
- LLamaSharp（CPU バックエンド）
- DocumentFormat.OpenXml
- Serilog / Serilog.Sinks.File
各コンポーネントのライセンスはそれぞれの公式リポジトリをご参照ください

## サポート
- 配布元またはリポジトリの「Issues」等、案内された窓口へお問い合わせください
- 問い合わせの際は以下情報をご提供ください
  - Windows のバージョン（例: Windows 11 23H2 64bit）
  - .NET デスクトップ ランタイムのバージョン（8.0.x, x64）
  - 配布物のバージョン（例: vX.Y.Z）
  - エラーメッセージやログ（可能な範囲で）

以上でインストールは完了です。展開フォルダー内の `LiquidAiNanoAppPiiMasker.exe` からご利用ください（トレイ常駐、左クリックでドラッグ＆ドロップ UI を表示、右クリックでメニュー操作）。
